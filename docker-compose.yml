services:
#   auth:
#     container_name: auth_service
#     build: 
#       context: ./auth
#       dockerfile: ./auth/Dockerfile
#     ports: 
#       - "8083:8083"
#     restart: always
#   chat:
#     container_name: chat_service
#     build:
#       context: ./chat
#       dockerfile: Dockerfile
#     ports:
#       - "8085:8085" 
#     restart: always
  postgres-prod:
    image: postgres 
    container_name: postgresDbProd 
    env_file:
      - "./postgres/migrations/.env"
    ports:
      - "${PG_PORT}:5432"
    volumes:
      - pgdata:/var/lib/postgresql/data
    environment:
      POSTGRES_USER: ${PG_USER}
      POSTGRES_PASSWORD: ${PG_PASSWORD}
      POSTGRES_DB: ${PG_DATABASE_NAME}

  migrator-prod:  
    container_name: migration-prod
    build:
      context: ./postgres/migrations
      dockerfile: migration.Dockerfile
    restart: on-failure
    
volumes:
  pgdata:
    driver: local